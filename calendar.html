{\rtf1\ansi\ansicpg936\cocoartf2639
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset134 PingFangSC-Regular;\f2\fnil\fcharset0 AppleColorEmoji;
}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="zh-CN">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>
\f1 \'ce\'d2\'b5\'c4
\f0 2026
\f1 \'d7\'a8\'ca\'f4\'c8\'d5\'c0\'fa\'c9\'fa\'b3\'c9\'c6\'f7
\f0 </title>\
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>\
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>\
    <style>\
        body \{ font-family: 'Helvetica Neue', Helvetica, 'Microsoft YaHei', Arial, sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 40px; color: #333; \}\
        .container \{ background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; max-width: 600px; width: 100%; \}\
        h1 \{ margin-bottom: 10px; color: #2c3e50; \}\
        p \{ color: #7f8c8d; margin-bottom: 30px; \}\
        \
        .upload-btn-wrapper \{ position: relative; overflow: hidden; display: inline-block; margin-bottom: 20px; \}\
        .btn \{ border: 2px solid #3498db; color: white; background-color: #3498db; padding: 12px 30px; border-radius: 50px; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.3s; \}\
        .btn:hover \{ background-color: #2980b9; border-color: #2980b9; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3); \}\
        .btn:disabled \{ background-color: #bdc3c7; border-color: #bdc3c7; cursor: not-allowed; transform: none; box-shadow: none; \}\
        \
        input[type=file] \{ font-size: 100px; position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer; \}\
        \
        #status \{ margin-top: 20px; font-size: 16px; font-weight: 500; min-height: 24px; \}\
        #progress-container \{ width: 100%; background-color: #e0e0e0; border-radius: 10px; margin-top: 20px; height: 10px; overflow: hidden; display: none; \}\
        #progress-bar \{ width: 0%; height: 100%; background-color: #2ecc71; transition: width 0.1s; \}\
\
        /* 
\f1 \'d4\'a4\'c0\'c0\'c7\'f8\'d3\'f2
\f0  (
\f1 \'d2\'fe\'b2\'d8
\f0 ) */\
        #canvas-container \{ display: none; \}\
    </style>\
</head>\
<body>\
\
<div class="container">\
    <h1>
\f2 \uc0\u55357 \u56517 
\f0  2026 
\f1 \'c8\'d5\'c0\'fa\'d2\'bb\'bc\'fc\'c9\'fa\'b3\'c9\'c6\'f7
\f0 </h1>\
    <p>
\f1 \'d1\'a1\'d4\'f1\'c4\'e3\'b5\'c4\'d5\'d5\'c6\'ac\'a3\'a8\'d6\'a7\'b3\'d6\'b6\'e0\'d1\'a1\'a3\'a9\'a3\'ac\'d7\'d4\'b6\'af\'c9\'fa\'b3\'c9
\f0  365 
\f1 \'d5\'c5\'c8\'d5\'c0\'fa\'cd\'bc\'c6\'ac\'b2\'a2\'b4\'f2\'b0\'fc\'cf\'c2\'d4\'d8\'a1\'a3
\f0 <br>
\f1 \'cb\'f9\'d3\'d0\'b4\'a6\'c0\'ed\'be\'f9\'d4\'da\'b1\'be\'b5\'d8\'bd\'f8\'d0\'d0\'a3\'ac\'d5\'d5\'c6\'ac\'b2\'bb\'bb\'e1\'c9\'cf\'b4\'ab\'a1\'a3
\f0 </p>\
    \
    <div class="upload-btn-wrapper">\
        <button class="btn" id="actionBtn">
\f1 \'d1\'a1\'d4\'f1\'d5\'d5\'c6\'ac\'b2\'a2\'bf\'aa\'ca\'bc\'d6\'c6\'d7\'f7
\f0 </button>\
        <input type="file" id="fileInput" multiple accept="image/*">\
    </div>\
\
    <div id="progress-container">\
        <div id="progress-bar"></div>\
    </div>\
    <div id="status">
\f1 \'b5\'c8\'b4\'fd\'bf\'aa\'ca\'bc
\f0 ...</div>\
</div>\
\
<div id="canvas-container">\
    <canvas id="calendarCanvas" width="1080" height="1920"></canvas>\
</div>\
\
<script>\
    const fileInput = document.getElementById('fileInput');\
    const statusDiv = document.getElementById('status');\
    const progressBar = document.getElementById('progress-bar');\
    const progressContainer = document.getElementById('progress-container');\
    const actionBtn = document.getElementById('actionBtn');\
\
    // 
\f1 \'c5\'e4\'d6\'c3
\f0 \
    const YEAR = 2026;\
    const CANVAS_WIDTH = 1080;\
    const CANVAS_HEIGHT = 1920;\
    const PHOTO_HEIGHT = 1500; // 
\f1 \'d5\'d5\'c6\'ac\'b8\'df\'b6\'c8
\f0 \
    \
    fileInput.addEventListener('change', async function(e) \{\
        const files = Array.from(e.target.files).filter(f => f.type.startsWith('image/'));\
        \
        if (files.length === 0) \{\
            statusDiv.textContent = "
\f1 \'c7\'eb\'d6\'c1\'c9\'d9\'d1\'a1\'d4\'f1\'d2\'bb\'d5\'c5\'cd\'bc\'c6\'ac\'a3\'a1
\f0 ";\
            return;\
        \}\
\
        // 
\f1 \'bd\'e7\'c3\'e6\'d7\'b4\'cc\'ac\'b8\'fc\'d0\'c2
\f0 \
        actionBtn.disabled = true;\
        actionBtn.textContent = "
\f1 \'d5\'fd\'d4\'da\'c9\'fa\'b3\'c9\'d6\'d0
\f0 ...";\
        progressContainer.style.display = 'block';\
        statusDiv.textContent = `
\f1 \'d7\'bc\'b1\'b8\'b4\'a6\'c0\'ed
\f0  $\{files.length\} 
\f1 \'d5\'c5\'cd\'bc\'c6\'ac
\f0 ...`;\
\
        const zip = new JSZip();\
        const canvas = document.getElementById('calendarCanvas');\
        const ctx = canvas.getContext('2d');\
        \
        // 
\f1 \'c9\'fa\'b3\'c9\'c8\'d5\'c6\'da\'c1\'d0\'b1\'ed
\f0 \
        const startDate = new Date(YEAR, 0, 1);\
        const endDate = new Date(YEAR, 11, 31);\
        let dateList = [];\
        let curr = new Date(startDate);\
        while (curr <= endDate) \{\
            dateList.push(new Date(curr));\
            curr.setDate(curr.getDate() + 1);\
        \}\
\
        // 
\f1 \'b4\'a6\'c0\'ed\'c3\'bf\'d2\'bb\'cc\'ec
\f0 \
        for (let i = 0; i < dateList.length; i++) \{\
            const date = dateList[i];\
            const file = files[i % files.length]; // 
\f1 \'d1\'ad\'bb\'b7\'ca\'b9\'d3\'c3\'cd\'bc\'c6\'ac
\f0 \
            \
            // 
\f1 \'b8\'fc\'d0\'c2\'bd\'f8\'b6\'c8\'cc\'f5
\f0 \
            const progress = Math.round(((i + 1) / dateList.length) * 100);\
            progressBar.style.width = `$\{progress\}%`;\
            statusDiv.textContent = `
\f1 \'d5\'fd\'d4\'da\'c9\'fa\'b3\'c9
\f0 : $\{date.getMonth() + 1\}
\f1 \'d4\'c2
\f0 $\{date.getDate()\}
\f1 \'c8\'d5
\f0  ($\{i + 1\}/365)`;\
\
            try \{\
                await drawCalendar(ctx, file, date);\
                \
                // 
\f1 \'bd\'ab
\f0  Canvas 
\f1 \'d7\'aa\'ce\'aa
\f0  Blob 
\f1 \'b2\'a2\'cc\'ed\'bc\'d3\'b5\'bd
\f0  Zip\
                const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg', 0.85));\
                const fileName = `$\{String(date.getMonth() + 1).padStart(2, '0')\}-$\{String(date.getDate()).padStart(2, '0')\}.jpg`;\
                zip.file(fileName, blob);\
                \
            \} catch (err) \{\
                console.error(err);\
            \}\
            \
            // 
\f1 \'b8\'f8\'e4\'af\'c0\'c0\'c6\'f7\'d2\'bb\'b5\'e3\'b4\'ad\'cf\'a2\'ca\'b1\'bc\'e4\'a3\'ac\'b7\'c0\'d6\'b9\'bf\'a8\'cb\'c0
\f0 \
            await new Promise(r => setTimeout(r, 10)); \
        \}\
\
        statusDiv.textContent = "
\f1 \'d5\'fd\'d4\'da\'b4\'f2\'b0\'fc\'d1\'b9\'cb\'f5\'ce\'c4\'bc\'fe
\f0 ...";\
        const content = await zip.generateAsync(\{type:"blob"\});\
        saveAs(content, `
\f1 \'ce\'d2\'b5\'c4
\f0 $\{YEAR\}
\f1 \'c8\'d5\'c0\'fa
\f0 .zip`);\
\
        statusDiv.textContent = "
\f1 \'cd\'ea\'b3\'c9\'a3\'a1\'d2\'d1\'bf\'aa\'ca\'bc\'cf\'c2\'d4\'d8\'a1\'a3
\f0 ";\
        actionBtn.disabled = false;\
        actionBtn.textContent = "
\f1 \'d4\'d9\'d7\'f6\'d2\'bb\'b4\'ce
\f0 ";\
        progressBar.style.width = '100%';\
    \});\
\
    async function drawCalendar(ctx, file, date) \{\
        // 1. 
\f1 \'c7\'e5\'bf\'d5\'bb\'ad\'b2\'bc
\f0 \
        ctx.fillStyle = "#ffffff";\
        ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\
\
        // 2. 
\f1 \'bc\'d3\'d4\'d8\'cd\'bc\'c6\'ac
\f0 \
        const imgBitmap = await createImageBitmap(file);\
        \
        // 3. 
\f1 \'bc\'c6\'cb\'e3\'b2\'c3\'bc\'f4
\f0  (
\f1 \'c4\'a3\'c4\'e2
\f0  object-fit: cover)\
        let drawWidth, drawHeight, offsetX, offsetY;\
        const targetRatio = CANVAS_WIDTH / PHOTO_HEIGHT;\
        const imgRatio = imgBitmap.width / imgBitmap.height;\
\
        if (imgRatio > targetRatio) \{\
            drawHeight = PHOTO_HEIGHT;\
            drawWidth = PHOTO_HEIGHT * imgRatio;\
            offsetY = 0;\
            offsetX = (CANVAS_WIDTH - drawWidth) / 2;\
        \} else \{\
            drawWidth = CANVAS_WIDTH;\
            drawHeight = CANVAS_WIDTH / imgRatio;\
            offsetX = 0;\
            offsetY = (PHOTO_HEIGHT - drawHeight) / 2;\
        \}\
\
        // 
\f1 \'bb\'e6\'d6\'c6\'cd\'bc\'c6\'ac\'c7\'f8\'d3\'f2\'a3\'a8\'b4\'f8\'c3\'c9\'b0\'e6\'b7\'c0\'d6\'b9\'d2\'e7\'b3\'f6\'a3\'a9
\f0 \
        ctx.save();\
        ctx.beginPath();\
        ctx.rect(0, 0, CANVAS_WIDTH, PHOTO_HEIGHT);\
        ctx.clip();\
        ctx.drawImage(imgBitmap, offsetX, offsetY, drawWidth, drawHeight);\
        ctx.restore();\
\
        // 4. 
\f1 \'bb\'e6\'d6\'c6\'ce\'c4\'d7\'d6
\f0 \
        const day = date.getDate();\
        const year = date.getFullYear();\
        const month = date.getMonth() + 1;\
        const weekdays = ["
\f1 \'d0\'c7\'c6\'da\'c8\'d5
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'d2\'bb
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'b6\'fe
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'c8\'fd
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'cb\'c4
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'ce\'e5
\f0 ", "
\f1 \'d0\'c7\'c6\'da\'c1\'f9
\f0 "];\
        const weekday = weekdays[date.getDay()];\
\
        // 
\f1 \'c9\'e8\'d6\'c3\'d7\'d6\'cc\'e5\'d1\'d5\'c9\'ab
\f0 \
        ctx.fillStyle = "#000000";\
        ctx.textAlign = "center";\
\
        // 
\f1 \'c8\'d5\'c6\'da\'ca\'fd\'d7\'d6
\f0 \
        ctx.font = "bold 180px 'Arial'";\
        ctx.fillText(day, CANVAS_WIDTH / 2, PHOTO_HEIGHT + 200);\
\
        // 
\f1 \'c4\'ea\'d4\'c2\'d0\'c7\'c6\'da
\f0 \
        ctx.font = "50px 'Microsoft YaHei'";\
        ctx.fillStyle = "#666666";\
        ctx.fillText(`$\{year\}
\f1 \'c4\'ea
\f0 $\{month\}
\f1 \'d4\'c2
\f0  \'b7 $\{weekday\}`, CANVAS_WIDTH / 2, PHOTO_HEIGHT + 320);\
    \}\
</script>\
\
</body>\
</html>}